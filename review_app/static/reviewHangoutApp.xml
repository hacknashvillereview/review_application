<?xml version="1.0" encoding="UTF-8" ?>
<Module>
<!-- Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy of
 * the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *      
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License
-->
        <ModulePrefs title="Hangout Starter">
                <Require feature="rpc" />
                <Require feature="views" />
                <Require feature="locked-domain" />
        </ModulePrefs>
        <Content type="html"><![CDATA[     
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/assets/img/ico/favicon.png">

    <title>Package presenter | Review</title>

    <!-- Bootstrap core CSS -->
    <link href="/assets/css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <style>
      /* Move down content because we have a fixed navbar that is 50px tall */
      body {
        padding-top: 50px;
        padding-bottom: 20px;
      }

      .sign-up {
        padding:8px 0 0 0;
      }

      .jumbotron {
        background-color:#7ef7ff;
        padding-top:40px;
        padding-bottom:0;
        position:fixed;
        right:0;
        left:0;
        z-index:-1;
      }

      .jumbotron h1 {
        font-size:50px;
        font-weight:800;
      }

      .jumbotron img {
        background:white;
        display:block;
        margin:50px auto 0 auto;
        width:700px;
        height:300px;
      }

      .btn.get-started {
        margin-top:30px;
      }

      .main-content {
        background-color:white;
        border-top:3px solid #ccc;
        margin-top:450px;
        width:100%;
      }

      .main-content img {
        margin-bottom:20px;
        width:300px;
        height:150px;
      }

      /*
        Package list
      */

      .package {
        margin-top:30px;
      }

      .add .package-content {
        background:#ddd;
      }

      .add .package-content:hover {
        background:#fff;
      }

      .add .package-content p {
        color:#777;
        display:block;
        font-size:100px;
        font-weight:bold;
        margin:0 auto;
        padding:30px 0 0 0;
        text-align:center;
      }

      .package-content {
        background-color:#777;
        border:1px solid #aaa;
        border-bottom:10px solid #aaa;
        cursor:pointer;
        height:200px;
        position:relative;
        transition: background-color 0.25s ease;
      }

      .package-content:hover {
        background-color:#aaa;
      }

      .package-content:hover span {
        color:#333;
      }

      .package-content h2 {
        color:#fff;
        display:block;
        font-size:20px;
        font-weight:normal;
        line-height:25px;
        margin:0;
        padding:10px;

        text-shadow:0px 1px 1px #000;
      }

      .package-content span {
        color:#777;
        display:block;
        font-size:50px;
        right:0;
        left:0;
        padding-right:20px;
        position:absolute;
        top:auto;
        bottom:20px;
        text-align:right;
        transition: color 0.25s ease;
      }

      .package p {
        font-size:12px;
        margin-top:10px;
      }

      /*
        Package - presenter
      */

      body.package {
        background-color:#444;
      }

      .actions h3 {
        color:white;
        margin-top:0;
      }

      .actions .btn-group {
        margin-bottom:10px; 
      }

      .actions .btn {
        background:#333;
        border-color:#888;
        color:#999;
      }

      .actions .btn:hover {
        background-color:#333; 
        color:#fff;
      }

      .actions .btn.active {
        background-color:#1e8823;
        color:#fff;
      }

      .actions .btn.active:hover {
        cursor:default;
      }

      .actions .pause {
        margin-left:10px;
      }

      .video {
        background-color:#aaa;
        margin-bottom:20px;
        width:100%;
        height:400px;
      }

      .attendees .list-group {
        background-color:#333;
        color:#fff;
        overflow-y:scroll;
        max-height:500px;
      }

      .attendees .list-group-item {
        background-color:#333;
        border-color:#666;
        border-left-width:5px;
        border-radius:0;
        color:#666;
      }

      .attendees .list-group-item span:hover {
        cursor:pointer;
      }

      .attendees .list-group-item.online {
        border-left-color:#1e8823;
        color:#ccc;
      }

      .attendees .list-group-item.alert {
        background:#59060f;
        border-top-color:#bf1e2e;
        border-left-color:#bf1e2e;
        color:#fff;
      }

      .attendees .list-group-item.question {
        color:#fff;
      }



      /*
        Media Queries
      */

      @media (min-width: 992px) {
        .col-lg-4 {
          float:left;
          width:33.3%;
        }
      }

      @media (max-width: 991px) {
        .col-lg-4 img {
          display:block;
          margin:0 auto;
          margin-bottom:20px;
        }
        .col-lg-4 h2 {
          text-align:center;
        }
      }

    </style>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="/assets/js/html5shiv.js"></script>
      <script src="/assets/js/respond.min.js"></script>
    <![endif]-->
  </head>

  <body class="package">

  <script src="//plus.google.com/hangouts/_/api/v1/hangout.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>

  <div class="container" id="presenter" style="display: none;">
    <div class="actions clearfix">
      <div class="title pull-left">
        <h3>Thursday team demo day</h3>
      </div>
      <button type="button" class="btn btn-default pull-right pause"><span class="glyphicon glyphicon-plus"></span>&nbsp;Notes</button>
      <button type="button" class="btn btn-default pull-right pause"><span class="glyphicon glyphicon-pause"></span></button>
      <div class="btn-group pull-right">
        <button type="button" class="btn btn-default active"><span class="glyphicon glyphicon-bullhorn"></span>&nbsp;&nbsp;Present</button>
        <button type="button" class="btn btn-default"><span class="glyphicon glyphicon-comment"></span>&nbsp;&nbsp;Collaborate</button>
      </div>
    </div>
    <div class="video">

    </div>
    <div class="row attendees">
      <div class="col-md-6">
        <ul class="list-group">
          <li class="list-group-item online">
            mtndewlover1978<span class="glyphicon glyphicon-bullhorn pull-right make-presenter"></span>
          </li>
          <li class="list-group-item online">
            Martin Lawrence<span class="glyphicon glyphicon-bullhorn pull-right make-presenter"></span>
          </li>
          <li class="list-group-item">
            Johnny Bravo<span class="glyphicon glyphicon-bullhorn pull-right make-presenter"></span>
          </li>
          <li class="list-group-item">
            newuser45678<span class="glyphicon glyphicon-bullhorn pull-right make-presenter"></span>
          </li>
        </ul>
      </div>
      <div class="col-md-6">
        <ul class="list-group alerts">
          <li class="list-group-item alert">
            mtndewlover1978 reported a problem.
          </li>
          <li class="list-group-item question">
            Martin has a Question.
          </li>
          <li class="list-group-item question">
            Martin has a Question.
          </li>
        </ul>
      </div>

<!-- my hacky stuff -->

<p>
<input class="button" type="button" value="Show participants" id="showParticipants" 
    style="visibility:hidden;"
    onClick="showParticipants()"/>
</p>

<p>
<input class="button" type="button" value="Mute participants" id="muteParticipants" 
    style="visibility:hidden;"
    onClick="muteParticipants()"/>
</p>

<div id="participantsDiv"></div>



    </div>


  <div class="container" id="attendee" style="display: none;">
    I'm Attending!`
  </div>

    <footer>
      <p>&copy; Review 2013</p>
    </footer>
  </div> <!-- /container -->


<script>
function showParticipants() {
  var participants = gapi.hangout.getParticipants();
  var isOnAir = gapi.hangout.onair.isOnAirHangout();

  console.log('isOnAir', isOnAir);

  var retVal = '<p>Participants: </p><ul>';

  for (var index in participants) {
    var participant = participants[index];

    if (!participant.person) {
      retVal += '<li>A participant not running this app</li>';
    }
    retVal += '<li>' + participant.person.displayName + '</li>';
  }

  retVal += '</ul>';

  var div = document.getElementById('participantsDiv');

  div.innerHTML = retVal;
}

function muteParticipants() {

  gapi.hangout.data.setValue('isPresenting','true');

  var participants = gapi.hangout.getParticipants();

  for (var index in participants) {
    var participant = participants[index];

    console.log(participant);

    if (participant.person) {
      gapi.hangout.av.muteParticipantMicrophone(participant.id);
    }
  }
}

function makePresenter (participantId) {
  console.log('Giving control to ', participantId);
  gapi.hangout.data.setValue('isPresenter', participantId);
}

function startPresenting() {
  var participant = gapi.hangout.getLocalParticipantId();
  gapi.hangout.data.setValue('tookControl', participant);
}

function isPresenter() {
  console.log('isPresenter, presenterId: ' + gapi.hangout.data.getValue('presenterId'));
  console.log('isPresenter, getLocalParticipantId: ' + gapi.hangout.getLocalParticipantId()); 
  return (gapi.hangout.data.getValue('presenterId') == gapi.hangout.getLocalParticipantId());
}

function updateLayout() {
  if (isPresenter()) {
    console.log('I\'m the presenter!');
    jQuery('#presenter').show();
    jQuery('#attendee').hide();
  } else {
    console.log('I\'m a participant!');
    jQuery('#presenter').hide();
    jQuery('#attendee').show();
  }
}

function init() {
  // When API is ready... 

  // set up globals
  var globalPresenterId = gapi.hangout.data.getValue('presenterId');
  console.log('presenterID = ' + globalPresenterId);

  if (typeof(globalPresenterId) == 'undefined') {
    gapi.hangout.data.setValue('presenterId',''+gapi.hangout.getLocalParticipantId());
    gapi.hangout.data.setValue('isPresenting','false');
    gapi.hangout.data.setValue('isPaused','true');
    gapi.hangout.data.setValue('releaseNotesUrl','');
  }

  gapi.hangout.data.onStateChanged.add(function (payload) {
    var div = document.getElementById('ownerDiv');
    var participant = gapi.hangout.getLocalParticipantId();

    updateLayout();

    console.log(payload);

    // Someone was set as the presenter
    if (payload.addedKeys[0].key === 'isPresenter') {
      div.innerHTML = '<h3>' +  payload.addedKeys[0].value + ' is now the presenter</h3>';

      if (payload.addedKeys[0].value === participant) {
        document.getElementById('startPresenting').style.visibility = 'visible';
      } else {
        document.getElementById('startPresenting').style.visibility = 'hidden';
      }

    // Presenter started the demo. Mute all mics.
    } else if (payload.addedKeys[0].key === 'tookControl') {
      if (payload.addedKeys[0].key !== participant) {
        gapi.hangout.av.setMicrophoneMute(true);
      } else {
        gapi.hangout.av.setMicrophoneMute(false);
      }
    }
  });

  gapi.hangout.onApiReady.add(
      function(eventObj) {
        if (eventObj.isApiReady) {
          showParticipants();
        }
      });
}

// Wait for gadget to load.                                                       
gadgets.util.registerOnLoadHandler(init);
</script>

  </body>
</html>
]]>
</Content>
</Module>